(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{123:function(e,t,a){e.exports=a(239)},141:function(e,t,a){},144:function(e,t,a){},146:function(e,t){e.exports="data:image/png;base64,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"},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){},173:function(e,t,a){},174:function(e,t,a){},235:function(e,t,a){e.exports=a.p+"static/media/logo-combined.4f7ebe9c.png"},236:function(e,t,a){e.exports=a.p+"static/media/exit.dd457aba.png"},237:function(e){e.exports={}},238:function(e){e.exports={}},239:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(25),s=a.n(o),c=a(9),i=a.n(c),l=a(12),u=a(11),p=a(15),m=a(17),f=a(16),h=a(18),d=a(241),g=a(242),b=a(243),v=a(58),E=a.n(v),y=(a(141),function(){return r.a.createElement(d.a,{fluid:!0,className:"waiter h-100 w-100 p-0 m-0 text-center"},r.a.createElement(g.a,{className:"h-100 w-100 p-0 m-0 align-items-center"},r.a.createElement(b.a,null,r.a.createElement(E.a,{color:"gray",size:10}))))}),w=a(61),k=a(244),x=(a(144),"https://cors-anywhere.herokuapp.com/https://megapolis.bpium.ru/auth/login"),A=function(e){return O.apply(this,arguments)};function O(){return(O=Object(l.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(x,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}var j=a(114),F=a.n(j),S=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={authFailed:!1,waiting:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"sendAuthRequest",value:function(){var e=Object(l.a)(i.a.mark(function e(t){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({waiting:!0}),e.next=3,A(t);case 3:a=e.sent,this.setState({waiting:!1}),console.log(a),200===a.status?(this.setState({authFailed:!1}),this.props.onAuthSuccess(t)):401===a.status&&this.setState({authFailed:!0});case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onFormSubmit",value:function(e){this.state.waiting||this.sendAuthRequest(e)}},{key:"render",value:function(){var e=this;return r.a.createElement(d.a,{fluid:!0,className:"Auth h-100 w-100 p-0 m-0"},r.a.createElement(F.a,{height:20,className:"logo mt-2 ml-2",src:a(146)}),r.a.createElement(g.a,{className:"flex-column h-100 w-100 p-0 m-0 align-items-center justify-content-center"},r.a.createElement(w.a,{onSubmit:function(t){return e.onFormSubmit(t)},initialValues:{}},r.a.createElement(b.a,{className:"px-0"},r.a.createElement("label",null,r.a.createElement(b.a,{className:"px-0 mb-1"},"\u041b\u043e\u0433\u0438\u043d"),r.a.createElement(b.a,{className:"email px-0"},r.a.createElement(w.b,{field:"email",type:"email"})))),r.a.createElement(b.a,{className:"px-0"},r.a.createElement("label",null,r.a.createElement(b.a,{className:"px-0 mb-1"},"\u041f\u0430\u0440\u043e\u043b\u044c"),r.a.createElement(b.a,{className:"password px-0"},r.a.createElement(w.b,{field:"password",type:"password"})))),r.a.createElement(b.a,{className:"warning px-0"},this.state.authFailed?"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043b\u043e\u0433\u0438\u043d \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c":""),r.a.createElement(b.a,{className:"px-0"},r.a.createElement(k.a,{variant:"success",type:"submit"},this.state.waiting?r.a.createElement(E.a,{size:7,color:"rgba(255,255,255,0.7)"}):"\u0412\u043e\u0439\u0442\u0438")))))}}]),t}(r.a.Component),N=a(115),D=a.n(N),M=a(116),I=a.n(M),T=a(32),R=a.n(T),z=(a(170),{1:{name:"\u0412\u044b\u0441\u043e\u043a\u0430\u044f",color:"rgba(203, 60, 62, 0.8)",colorMuted:"rgba(240, 201, 202, 0.8)"},2:{name:"\u0421\u0440\u0435\u0434\u043d\u044f\u044f",color:"rgba(255, 147, 15, 0.8)",colorMuted:"rgba(255, 226, 190, 0.8)"},3:{name:"\u041d\u0438\u0437\u043a\u0430\u044f",color:"rgba(81, 175, 43, 0.8)",colorMuted:"rgba(208, 251, 191, 0.8)"},4:{name:"\u041f\u043b\u0430\u043d\u043e\u0432\u0430\u044f",color:"rgba(84, 213, 255, 0.8)",colorMuted:"rgba(213, 245, 255, 0.8)"},default:{name:"\u0412 \u043f\u043e\u0440\u044f\u0434\u043a\u0435",color:"rgba(99, 99, 99, 0.7)",colorMuted:"rgba(200, 200, 200, 0.7)"}}),P=function(e){var t=[];e.points.forEach(function(e){e.applications.forEach(function(e){t.push(e.criticality)})});var a=t.length,n=a?Math.min.apply(Math,t):null,o=20+2*a;o>100&&(o=100);var s=null!==n?z[n].color:z.default.colorMuted;return r.a.createElement(R.a,{className:"cluster px-0 justify-content-center align-items-center",style:{height:o,width:o,marginTop:-o/2,marginLeft:-o/2,backgroundColor:s},onClick:function(){return e.onClick(e.lat,e.lng,e.points.length>1)}},r.a.createElement("span",{className:"title"},a))},L=(a(171),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={clusters:[]},a.mapOptions={center:t.defaultProps.center,zoom:t.defaultProps.zoom},a.onMapChange=function(e){a.mapOptions=e;var n=a.props.data?a.props.data:[],r=t.createClusters(a.mapOptions,n);a.setState({clusters:r})},a.handleApiLoaded=function(e,t){a.internals={map:e,maps:t}},a.onMarkerClick=function(e,t,n){var r=a.mapOptions.zoom+1;n&&a.internals.map.setZoom(r),a.internals.map.panTo(new a.internals.maps.LatLng(e,t)),a.internals.map.panBy(175,0)},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){e.data!==this.props.data&&this.onMapChange(this.mapOptions)}},{key:"render",value:function(){var e=this,a=this.state.clusters.map(function(t){return r.a.createElement(P,{key:t.id,lat:t.lat,lng:t.lng,points:t.points,onClick:e.onMarkerClick})});return r.a.createElement(R.a,{fluid:!0,className:"map h-100 w-100 px-0"},r.a.createElement(D.a,{bootstrapURLKeys:{language:"ru",region:"ru"},defaultCenter:t.defaultProps.center,defaultZoom:t.defaultProps.zoom,onChange:this.onMapChange,options:function(){return{disableDefaultUI:!0}},yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:function(t){var a=t.map,n=t.maps;return e.handleApiLoaded(a,n)}},a))}}],[{key:"createClusters",value:function(e,t){return I()(t)(e).map(function(e){var t=e.wx,a=e.wy,n=e.numPoints,r=e.points;return{lat:a,lng:t,numPoints:n,id:"".concat(n,"_").concat(r[0].id),points:r}})}}]),t}(r.a.Component));L.defaultProps={center:{lat:61.25,lng:73.38},zoom:4};a(172);var C=a(117),G=a.n(C),U=(a(173),function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(G.a,{className:"Frame m-0",style:{paddingTop:this.props.view.FRAME_PY,paddingBottom:this.props.view.FRAME_PY,paddingRight:this.props.view.FRAME_PX,paddingLeft:this.props.view.FRAME_PX}},r.a.createElement(R.a,{fluid:!0,className:"p-0 m-0 h-100 w-100"},r.a.createElement("div",{className:"iframe-container"},r.a.createElement("div",{onClick:this.props.closeFrame,className:"close-button"},"\u2715"),r.a.createElement("iframe",{width:"100%",height:"100%",src:"https://megapolis.bpium.ru/?action=record-open&catalog=12&record=".concat(this.props.recordId,"&screen=full")}))))}}]),t}(r.a.Component)),H=(a(174),a(81)),X=a(80),Z=a.n(X),Q=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement(Z.a,{placeholder:"\u041f\u043e\u0438\u0441\u043a...",onSearchClick:this.props.onSearch,onEnter:this.props.onSearch})}}]),t}(n.Component),Y=[];for(var B in z)Y.push({key:B,info:z[B],selected:!0});var V=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={filterTitles:Y,stopIndex:null,startIndex:null},a.changeFilters=function(){var e={criticality:[]};a.state.filterTitles.forEach(function(t){t.selected&&e.criticality.push(t.key)}),a.props.filterData(e)},a.toggleFilterSelect=function(e){var t=a.state.filterTitles.slice();t[e].selected=!t[e].selected,a.setState({filterTitles:t}),a.changeFilters()},a.blurerHeight=12,a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.hardcodeBlurBottomCorner()}},{key:"hardcodeBlurBottomCorner",value:function(){var e=this.refs.bottomBlurer,t=e.getContext("2d"),a=t.createLinearGradient(0,0,0,e.height);a.addColorStop(0,"rgba(255,255,255,0)"),a.addColorStop(1,"rgba(255,255,255,0.8)"),t.fillStyle=a,t.fillRect(0,0,this.props.view.LIST_WIDTH,e.height)}},{key:"render",value:function(){var e=this,t=this.state.filterTitles.map(function(t,a){return r.a.createElement(W,{key:t.info.name,title:t.info.name,color:t.info.color,colorMuted:t.info.colorMuted,selected:t.selected,index:a,toggleFilterSelect:e.toggleFilterSelect})}),n=this.props.data.length-this.state.stopIndex-1;return r.a.createElement(d.a,{className:"List h-100 px-0 mx-0",style:{width:this.props.view.LIST_WIDTH}},r.a.createElement(d.a,{className:"list-header",style:{height:155}},r.a.createElement(g.a,{className:"px-3 pt-2 pb-2",style:{height:40}},r.a.createElement(b.a,{className:"d-flex flex-grow-1 p-0 logo-image align-items-center"},r.a.createElement("img",{height:22,src:a(235),alt:"BPIUM"})),r.a.createElement(b.a,{className:"exit p-0 m-0 flex-grow-0",onClick:this.props.exit},r.a.createElement("img",{height:20,src:a(236)}))),r.a.createElement(b.a,{className:"d-flex flex-wrap px-0 mx-0 pb-0 pt-1 align-content-center"},r.a.createElement(Q,{onSearch:this.props.searchData})),r.a.createElement(b.a,{className:"titles d-flex flex-wrap px-0 pb-1 pt-1 align-content-center"},t)),r.a.createElement(H.a,null,function(t){var a=t.height,o=t.width;return r.a.createElement(H.b,{rowHeight:40,rowCount:e.props.data.length,rowRenderer:function(t){var a=t.index,n=t.key,o=t.style;return r.a.createElement("div",{key:n,style:o},r.a.createElement(q,{id:e.props.data[a].id,name:e.props.data[a].address,applications:e.props.data[a].applications,openFrame:e.props.openFrame}))},onRowsRendered:function(t){var a=t.startIndex,n=t.stopIndex;return e.setState({startIndex:a,stopIndex:n})},height:a-155-(n>0?30:0),width:o})}),r.a.createElement("canvas",{className:"blur-bottom-corner",ref:"bottomBlurer",hidden:n<=0,height:this.blurerHeight,width:this.props.view.LIST_WIDTH-5}),r.a.createElement(J,{count:n}))}}]),t}(r.a.Component),J=function(e){return e.count>0?r.a.createElement(b.a,{className:"remain-info w-100 px-3 m-0",style:{height:30}},"\u0438 \u0435\u0449\u0435 ".concat(e.count," \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432...")):null},W=function(e){return r.a.createElement(b.a,{onMouseDown:function(e){return e.preventDefault()},onDoubleClick:function(e){return e.preventDefault()},onClick:function(){e.toggleFilterSelect(e.index)},className:"d-flex flex-wrap flex-grow-0 px-0 text-center"},r.a.createElement("div",{style:{backgroundColor:e.selected?e.colorMuted:null,color:e.color},className:"filter-title"},e.title))},q=function(e){var t={};e.applications.forEach(function(e){t[e.criticality]=t[e.criticality]?t[e.criticality]++:1});var a=[];for(var n in t)a.push(r.a.createElement(K,{key:n,count:t[n],colorMuted:z[n].colorMuted,color:z[n].color}));return r.a.createElement(d.a,{className:"p-0 mx-0"},r.a.createElement(g.a,{className:"list-item px-3 m-0 align-items-center",onClick:function(){return e.openFrame(e.id)}},r.a.createElement(b.a,{title:e.name,className:"flex-grow-1 name px-0 mx-0"},e.name),a))},K=function(e){return r.a.createElement(b.a,{className:"flex-grow-0 filter-item px-0 text-center",style:{backgroundColor:e.colorMuted,color:e.color}},e.count)},_=a(121),$=a.n(_),ee={LIST_WIDTH:350,FRAME_PX:70,FRAME_PY:30},te=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={frameOpen:!1,recordId:null},a.openFrame=function(e){a.setState({frameOpen:!0,recordId:e})},a.closeFrame=function(){a.setState({frameOpen:!1,recordId:null})},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=r.a.createElement(V,Object.assign({key:"list"},this.props,{data:this.props.data.concat(this.props.data).concat(this.props.data).concat(this.props.data).concat(this.props.data).concat(this.props.data).concat(this.props.data),openFrame:this.openFrame,view:ee}));return this.state.frameOpen?r.a.createElement(R.a,{fluid:!0,className:"Interface h-100 w-100 p-0 m-0"},r.a.createElement($.a,{className:"h-100 w-100 p-0 m-0"},r.a.createElement(U,{key:"frame",closeFrame:this.closeFrame,recordId:this.state.recordId,view:ee}),e)):r.a.createElement("div",{className:"Interface frame-closed p-0 m-0 h-100"},e)}}]),t}(r.a.Component),ae="https://cors-anywhere.herokuapp.com/https://megapolis.bpium.ru/api/v1",ne=function(e,t){return re.apply(this,arguments)};function re(){return(re=Object(l.a)(i.a.mark(function e(t,a){var n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={"Content-Type":"application/json"},a&&(n.Authorization="Basic "+btoa("".concat(a.email,":").concat(a.password))),e.next=4,fetch(ae+t,{method:"GET",headers:n});case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var oe=a(122),se="https://cors-anywhere.herokuapp.com/https://megapolis.bpium.ru/api/v1",ce=function(e,t,a,n){return ie.apply(this,arguments)};function ie(){return(ie=Object(l.a)(i.a.mark(function e(t,a,n,r){var o,s,c;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={"Content-Type":"application/json"},r&&(o.Authorization="Basic "+btoa("".concat(r.email,":").concat(r.password))),(s={values:{}}).values[a]=n,e.next=6,fetch(se+t,{method:"PATCH",headers:o,body:JSON.stringify(s)});case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var le=new window.google.maps.Geocoder,ue=function(e,t){return pe.apply(this,arguments)};function pe(){return(pe=Object(l.a)(i.a.mark(function e(t,a){var n,r,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),n={},r=[],t.branches.forEach(function(e){var t=e.id,o=e.values[6],s=e.values[20],c=[];if(s){var u=s.split(",").map(function(e){return+e}),p=Object(oe.a)(u,2),m=p[0],f=p[1];n[t]={address:o,lat:m,lng:f,applications:c}}else r.push(new Promise(function(e,r){le.geocode({address:o,region:"ru"},function(){var r=Object(l.a)(i.a.mark(function r(s,l){var u,p,m,f;return i.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("OK"!==l){r.next=15;break}if(u=s[0].geometry.location.lat(),p=s[0].geometry.location.lng(),"ROOFTOP"!==(m=s[0].geometry.location_type)&&"RANGE_INTERPOLATED"!==m){r.next=12;break}return n[t]={address:o,lat:u,lng:p,applications:c},r.next=8,ce("/catalogs/12/records/".concat(t),"20","".concat(u,",").concat(p),a);case 8:f=r.sent,console.log(o," coords writing: ",f.status),r.next=13;break;case 12:console.log("Incorrect address "+o+" skipped, id ",t);case 13:r.next=16;break;case 15:console.log("Error: ",o,l);case 16:e();case 17:case"end":return r.stop()}},r)}));return function(e,t){return r.apply(this,arguments)}}())}))}),e.next=6,Promise.all(r);case 6:for(s in t.applications.forEach(function(e){var t=e.axis.recordId,a=e.values.map(function(e){return{criticality:+e.split}});n[t]&&(n[t].applications=a)}),o=[],n)n[s].id=s,o.push(n[s]);return e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function me(e,t,a){var n=[];return e.forEach(function(e){if(e.address.toLowerCase().includes(a.toLowerCase())){var r=e.applications.slice();if(!e.applications.length&&t.criticality&&t.criticality.includes("default"))n.push(Object.assign({},e));else{var o=function(e){r=r.filter(function(a){return~t[e].indexOf(""+a[e])})};for(var s in t)o(s);r.length&&((e=Object.assign({},e)).applications=r,n.push(e))}}}),n}a(237),a(238);var fe=function e(t){Object(u.a)(this,e),this.status=t.status,this.statusText=t.statusText},he=1e3;function de(e,t){return ge.apply(this,arguments)}function ge(){return(ge=Object(l.a)(i.a.mark(function e(t,a){var n,r,o,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=0;case 2:return e.next=4,ne("".concat(t).concat(t.includes("?")?"&":"?","limit=").concat(he,"&offset=").concat(r),a);case 4:if(200!==(s=e.sent).status){e.next=12;break}return e.next=8,s.json();case 8:o=e.sent,n=n.concat(o),e.next=13;break;case 12:return e.abrupt("return",fe(s));case 13:r+=he;case 14:if(o.length>0){e.next=2;break}case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}var be=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(m.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(r)))).state={authRequired:!0,error:!1,waiting:!1,data:null,filteredData:null},a.filter={},a.search="",a.filterData=function(e){a.filter=e,a.setState({filteredData:me(a.state.data,a.filter,a.search)},function(){return console.log("filtered data:",a.state.filteredData)})},a.searchData=function(e){e||(e=""),a.search=e,a.setState({filteredData:me(a.state.data,a.filter,a.search)},function(){return console.log("filtered data:",a.state.filteredData)})},a.exit=function(){a.setState({authRequired:!0,data:null,filteredData:null})},a.onError=function(e){a.setState({error:e})},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.checkAccess()}},{key:"checkAccess",value:function(){var e=Object(l.a)(i.a.mark(function e(){var t;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({waiting:!0}),e.next=3,ne("");case 3:404===(t=e.sent).status?this.onAuthSuccess():401===t.status?this.setState({waiting:!1}):this.onError(t);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"onAuthSuccess",value:function(e){this.getData(e)}},{key:"getData",value:function(){var e=Object(l.a)(i.a.mark(function e(t){var a,n;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object.assign({},t),this.setState({waiting:!0}),e.next=4,de("/catalogs/12/records",t);case 4:return e.t0=e.sent,e.next=7,de("/boards/1/widgets/new/values?timezoneOffset=180&value[type]=recordsCount&value[value]=&valueFn=&axis[type]=field&axis[value]=3&split[type]=field&split[value]=10&recordsFilter[filters][0][fieldId]=5&recordsFilter[filters][0][value][0]=1&recordsFilter[filters][0][value][1]=2&recordsFilter[filters][0][value][2]=3&recordsFilter[filters][0][value][3]=4&recordsFilter[filters][0][value][4]=5&recordsFilter[filters][0][value][5]=6&order=value",t);case 7:e.t1=e.sent,a={branches:e.t0,applications:e.t1},e.t2=i.a.keys(a);case 10:if((e.t3=e.t2()).done){e.next=17;break}if(n=e.t3.value,!(a[n]instanceof fe)){e.next=15;break}return this.onError(a[n]),e.abrupt("return");case 15:e.next=10;break;case 17:return e.next=19,ue(a,t);case 19:a=e.sent,this.setState({authRequired:!1,data:a,filteredData:a,waiting:!1}),console.log("data:",this.state.data);case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=!this.state.waiting&&this.state.authRequired?r.a.createElement(S,{key:"auth",onAuthSuccess:function(t){return e.onAuthSuccess(t)}}):null,a=this.state.waiting?r.a.createElement(y,{key:"waiter"}):null,n=r.a.createElement(L,{key:"map",data:this.state.filteredData}),o=[a,t,this.state.filteredData?r.a.createElement(te,{key:"interface",data:this.state.filteredData,filterData:this.filterData,searchData:this.searchData,exit:this.exit}):null,n];return this.state.error&&(o=r.a.createElement(ve,{res:this.state.error})),o}}]),t}(n.Component),ve=function(e){return r.a.createElement("div",null,"".concat(e.res.status," ").concat(e.res.statusText))};s.a.render(r.a.createElement(be,null),document.getElementById("root"))}},[[123,1,2]]]);
//# sourceMappingURL=main.981415ef.chunk.js.map